version: 'v1.6.0'
description: 'Training workflow github event based'
workflows:
  - name: 'training-workflow'
    type: training
    processes:
      - name: 'github-trigger'
        image: 'kai-local-registry:5000/demo_github-trigger:v2'
        type: 'trigger'
        resourceLimits:
          CPU:
            request: 100m
            limit: 200m
          memory:
            request: 100M
            limit: 200M
        config:
          webhook_events: push
          github_secret: dummy
        subscriptions:
          - exit

      - name: 'splitter'
        image: 'kai-local-registry:5000/demo_splitter:v2'
        type: 'task'
        resourceLimits:
          CPU:
            request: 100m
            limit: 200m
          memory:
            request: 100M
            limit: 200M
        subscriptions:
          - github-trigger

      - name: 'training-go'
        image: 'kai-local-registry:5000/demo_training-go:v2'
        type: 'task'
        resourceLimits:
          CPU:
            request: 100m
            limit: 200m
          memory:
            request: 100M
            limit: 200M
        subscriptions:
          - splitter.go

      - name: 'training-py'
        image: 'kai-local-registry:5000/demo_training-py:v2'
        type: 'task'
        resourceLimits:
          CPU:
            request: 100m
            limit: 200m
          memory:
            request: 100M
            limit: 200M
        subscriptions:
          - splitter.py

      - name: 'validation'
        image: 'kai-local-registry:5000/demo_validation:v1'
        type: 'task'
        resourceLimits:
          CPU:
            request: 100m
            limit: 200m
          memory:
            request: 100M
            limit: 200M
        subscriptions:
          - 'training-go'
          - 'training-py'

      - name: 'exit'
        image: 'kai-local-registry:5000/demo_exit:v1'
        type: 'exit'
        resourceLimits:
          CPU:
            request: 100m
            limit: 200m
          memory:
            request: 100M
            limit: 200M
        subscriptions:
          - 'validation'
